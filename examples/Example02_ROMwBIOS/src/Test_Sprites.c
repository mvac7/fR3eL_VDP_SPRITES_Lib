/* =============================================================================
# Test Sprites

- Version: 1.4 (10/06/2025)
- Author: mvac7/303bcn
- Architecture: MSX
- Format: 16K ROM (BIOS+ROM+RAM+RAM)
- Programming language: C and Z80 assembler
- Compiler: SDCC 4.4 or newer

## Description:

Perform a test of the functions of the VDP_SPRITE library for MSX ROM 
environment using VDP_TMS9918A_MSXBIOS Library.
    
## History of versions (dd/mm/yyyy):
- v1.4 (10/06/2025)
	- Update to SDCC (4.1.12) Z80 calling conventions.
	- Added display of test parameters.
- v1.3.1 (7/05/2019)
- v1.3 (30/04/2019) 
- v1.2 (19/04/2018) 
- v1.1 ( 2/03/2017)    
- v1.0 (25/02/2017) First version
============================================================================= */

#include "../include/newTypes.h"
#include "../include/msxBIOS.h"
#include "../include/msxSystemVariables.h"

#include "../include/VDP_TMS9918A_MSXBIOS.h"
#include "../include/VDP_PRINT.h"
#include "../include/VDP_SPRITES.h"



// ---------------------------------------------------------------------------- Labels
#define  HALT __asm halt __endasm   //wait for the next interrupt

#define WAIT_TIME 50



// ---------------------------------------------------------------------------- Function Declaration
void WAIT(uint cicles);
char INKEY(void);

//void VPRINT(char column, char line, char* text);  //print in screen 1 or 2
//void VPOKEARRAY(uint vaddr, char* text);

void VLocateNL(void);
void LOCATE(char x, char y);

//char PEEK(uint address);

void setFont(void);

void setSpritesPatterns(void);
void showSprites(char offset);
void setTestSPRcolor(char ncolor);

void testSPRITES(void);
void testSpritePosition(void);
void testSpriteColor(void);
void testSpritePattern(void);
void testSpriteVisible(void);



// ---------------------------------------------------------------------------- Constants
const char text01[] = "Test TMS9918A SPRITES Libraries";
const char text02[] = "Press any key";


const char sprcol[16]={
12, 2, 3, 7,
 6, 8, 9,14,
 3,10,12,11,
13, 9,10,15};

// ---------------------------------------------------------
// tMSgfX devtool v0.9.16.0
// Project: TestTMS_sprites.PNG
// ---------------------------------------------------------
// SpriteSet Pattern Data - Size=16x16 - Mode=Mode1 Monocolor
// Sprite range: 0 to 9
// Size=320
const char SPRITE_DATA[]={
0x3C,0x42,0xA5,0x81,0xA5,0x99,0x42,0x3C,
0x3C,0x7E,0xDB,0xFF,0xFF,0xDB,0x66,0x3C,
0x6C,0xFE,0xFE,0xFE,0x7C,0x38,0x10,0x00,
0x10,0x38,0x7C,0xFE,0x7C,0x38,0x10,0x00,
0x10,0x38,0x54,0xFE,0x54,0x10,0x38,0x00,
0x10,0x38,0x7C,0xFE,0xFE,0x10,0x38,0x00,
0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xE7,0xE7,0xFF,0xFF,0xFF,
0x0F,0x1F,0x3D,0x3F,0x7B,0x7C,0xBF,0xBF,
0x9F,0xEF,0x6F,0x1F,0x0F,0x05,0x05,0x1D,
0xC0,0xE0,0x60,0xC0,0x40,0x80,0x80,0x84,
0x86,0xDE,0xC0,0xC0,0x80,0x00,0x00,0xC0,
0x05,0x07,0x1A,0x2E,0x6F,0x5B,0x5C,0x5B,
0x5F,0x58,0x6F,0x2D,0x16,0x02,0x02,0x06,
0x40,0xC0,0xB8,0xD4,0xD4,0x6A,0xEA,0x6A,
0xEA,0x6A,0xD4,0xD4,0xF8,0x40,0x40,0x60,
0x03,0x07,0x4F,0xCF,0x4D,0x4F,0x2C,0x1E,
0x3F,0x3F,0x3F,0x3F,0x1F,0x02,0x02,0x06,
0xC0,0xE2,0xE6,0xE2,0xA2,0xF4,0x38,0x7C,
0xFE,0xFE,0xFE,0xFC,0xF8,0x40,0x40,0x60,
0x05,0x1E,0x3F,0x6F,0x57,0x6E,0x3F,0x00,
0x07,0x05,0x07,0x04,0x06,0x03,0x02,0x06,
0x60,0xF8,0xF4,0xEA,0x76,0xBE,0x7C,0x00,
0xE0,0x60,0xE0,0x20,0x60,0xC0,0x40,0x60,
0x05,0x07,0x1F,0x3F,0x7F,0x7F,0x7F,0x7D,
0x7F,0x7F,0x78,0x3F,0x1F,0x04,0x04,0x0C,
0x40,0xC0,0xF0,0xF8,0xFC,0xFC,0xFC,0x7C,
0xFC,0xFC,0x3C,0xF8,0xF0,0x40,0x40,0x60,
0x07,0x1F,0x3F,0x3F,0x7F,0x71,0x7F,0x7F,
0x7F,0x7E,0x3E,0x3F,0x1F,0x07,0x02,0x06,
0xE0,0xF8,0xFC,0xFC,0xFE,0x8E,0xFE,0xFE,
0xFE,0x7E,0x7C,0xFC,0xF8,0xE0,0x40,0x60,
0x00,0x07,0x1F,0x3F,0x7F,0x71,0xFF,0xFF,
0x7B,0x7C,0x3F,0x1F,0x07,0x02,0x02,0x06,
0x00,0xE0,0xF8,0xFC,0xFE,0x8E,0xFF,0xFF,
0xDE,0x3E,0xFC,0xF8,0xE0,0x40,0x40,0x60,
0x05,0x1E,0x3F,0x6F,0x57,0x6E,0x3F,0x00,
0x07,0x05,0x07,0x04,0x06,0x03,0x02,0x06,
0x60,0xF8,0xF4,0xEA,0x76,0xBE,0x7C,0x00,
0xE0,0x60,0xE0,0x20,0x60,0xC0,0x40,0x60};



// ByteniZ3R devtool v0.9.29.0-beta
// Project: VDP_SPRITES
// WF: Sine Unsigned Length=256 Min=16 Max=144 Phase=0 Freq=1
const char SIN[]={
0x50,0x52,0x53,0x55,0x56,0x58,0x59,0x5B,0x5D,0x5E,0x60,0x61,0x63,0x64,0x66,0x67,
0x69,0x6A,0x6B,0x6D,0x6E,0x70,0x71,0x72,0x74,0x75,0x76,0x78,0x79,0x7A,0x7B,0x7C,
0x7D,0x7E,0x80,0x81,0x82,0x83,0x84,0x84,0x85,0x86,0x87,0x88,0x89,0x89,0x8A,0x8B,
0x8B,0x8C,0x8C,0x8D,0x8D,0x8E,0x8E,0x8F,0x8F,0x8F,0x8F,0x90,0x90,0x90,0x90,0x90,
0x90,0x90,0x90,0x90,0x90,0x8F,0x8F,0x8F,0x8F,0x8E,0x8E,0x8E,0x8D,0x8D,0x8C,0x8C,
0x8B,0x8A,0x8A,0x89,0x88,0x87,0x87,0x86,0x85,0x84,0x83,0x82,0x81,0x80,0x7F,0x7E,
0x7D,0x7C,0x7B,0x79,0x78,0x77,0x76,0x74,0x73,0x72,0x70,0x6F,0x6E,0x6C,0x6B,0x69,
0x68,0x66,0x65,0x63,0x62,0x60,0x5F,0x5D,0x5C,0x5A,0x59,0x57,0x56,0x54,0x52,0x51,
0x4F,0x4E,0x4C,0x4A,0x49,0x47,0x46,0x44,0x43,0x41,0x40,0x3E,0x3D,0x3B,0x3A,0x38,
0x37,0x35,0x34,0x32,0x31,0x30,0x2E,0x2D,0x2C,0x2A,0x29,0x28,0x27,0x25,0x24,0x23,
0x22,0x21,0x20,0x1F,0x1E,0x1D,0x1C,0x1B,0x1A,0x19,0x19,0x18,0x17,0x16,0x16,0x15,
0x14,0x14,0x13,0x13,0x12,0x12,0x12,0x11,0x11,0x11,0x11,0x10,0x10,0x10,0x10,0x10,
0x10,0x10,0x10,0x10,0x10,0x11,0x11,0x11,0x11,0x12,0x12,0x13,0x13,0x14,0x14,0x15,
0x15,0x16,0x17,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1C,0x1D,0x1E,0x1F,0x20,0x22,0x23,
0x24,0x25,0x26,0x27,0x28,0x2A,0x2B,0x2C,0x2E,0x2F,0x30,0x32,0x33,0x35,0x36,0x37,
0x39,0x3A,0x3C,0x3D,0x3F,0x40,0x42,0x43,0x45,0x47,0x48,0x4A,0x4B,0x4D,0x4E,0x50};



// Tileset Color Data - Mode:G1
// Size=32
const char tileset_06x8_COL2[]={
0x94,0x94,0x34,0x34,
0xB4,0xB4,0x74,0x74,
0xF4,0xF4,0xF4,0xF4,
0xF4,0xF4,0xF4,0xF4,
0xFD,0xE4,0xF5,0xE7,
0xEC,0xF2,0xE3,0xFA,
0xF6,0xE8,0xF9,0xEB,
0xE1,0xFE,0xEF,0xF0};



// Project: mvac7_font_v0.2
// tileset pattern
// Tiles range: 0 to 125
// Size= 1008
const unsigned char TILESET_FONT[]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x8F,0x81,0xBD,0xBD,0xBD,0x81,0xFF,
0x87,0xB3,0xB1,0xBD,0xBD,0xBD,0x81,0xFF,0x80,0x80,0x80,0xBE,0x80,0x80,0x80,0xFF,
0x80,0x88,0x88,0xBE,0x88,0x88,0x80,0xFF,0x80,0x80,0x80,0xBE,0x9C,0x88,0x80,0x80,
0x5C,0x62,0x70,0x5E,0x42,0x42,0x7E,0x00,0xFC,0xBA,0xBA,0x82,0x82,0x82,0xFE,0x00,
0x00,0x00,0x08,0x1C,0x3E,0x00,0x00,0x00,0x00,0x00,0x00,0x3E,0x1C,0x08,0x00,0x00,
0x00,0x08,0x18,0x38,0x18,0x08,0x00,0x00,0x00,0x10,0x18,0x1C,0x18,0x10,0x00,0x00,
0x00,0x00,0x1C,0x22,0x22,0x22,0x1C,0x00,0x00,0x00,0x1C,0x3E,0x3E,0x3E,0x1C,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x0C,0x0C,0x0C,0x3F,0x0C,0x0C,0x0C,0x0C,0x18,0x18,0x18,0x7F,0x7F,0x00,0x00,0x00,
0x00,0x00,0x00,0xFF,0xFF,0x18,0x18,0x18,0x18,0x18,0x18,0xF8,0xF8,0x18,0x18,0x18,
0x18,0x18,0x18,0x1F,0x1F,0x18,0x18,0x18,0x18,0x18,0x18,0xFF,0xFF,0x18,0x18,0x18,
0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,
0x00,0x00,0x00,0x0F,0x1F,0x18,0x18,0x18,0x00,0x00,0x00,0xF0,0xF8,0x18,0x18,0x18,
0x18,0x18,0x18,0x1F,0x0F,0x00,0x00,0x00,0x18,0x18,0x18,0xF8,0xF0,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0xFF,0xFF,0x08,0x08,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x18,0x18,0x18,0x00,0x18,0x00,
0x28,0x28,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7C,0x28,0x7C,0x28,0x00,
0x10,0x7C,0xD0,0x7C,0x16,0x16,0x7C,0x10,0x00,0xC6,0xCC,0x18,0x30,0x66,0xC6,0x00,
0x00,0x70,0xD8,0x7A,0xCC,0xCC,0x7A,0x00,0x18,0x30,0x00,0x00,0x00,0x00,0x00,0x00,
0x18,0x30,0x60,0x60,0x60,0x30,0x18,0x00,0x60,0x30,0x18,0x18,0x18,0x30,0x60,0x00,
0x00,0x00,0x54,0x38,0x7C,0x38,0x54,0x00,0x00,0x00,0x30,0x30,0xFC,0x30,0x30,0x00,
0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x20,0x00,0x00,0x00,0x00,0x7C,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x06,0x0C,0x18,0x30,0x60,0xC0,0x00,
0x7C,0xC6,0xCE,0xD6,0xE6,0xC6,0x7C,0x00,0x30,0x70,0x30,0x30,0x30,0x30,0x78,0x00,
0xFC,0x06,0x06,0x7C,0xC0,0xC0,0xFE,0x00,0xFC,0x06,0x06,0x7C,0x06,0x06,0xFC,0x00,
0xC6,0xC6,0xC6,0xFE,0x06,0x06,0x06,0x00,0xFE,0xC0,0xC0,0xFC,0x06,0x06,0xFC,0x00,
0x7C,0xC0,0xC0,0xFC,0xC6,0xC6,0x7C,0x00,0xFE,0x06,0x0C,0x18,0x30,0x30,0x30,0x00,
0x7C,0xC6,0xC6,0x7C,0xC6,0xC6,0x7C,0x00,0x7C,0xC6,0xC6,0x7E,0x06,0x06,0x7C,0x00,
0x00,0x30,0x30,0x00,0x30,0x30,0x00,0x00,0x00,0x30,0x30,0x00,0x30,0x30,0x20,0x00,
0x00,0x00,0x18,0x30,0x60,0x30,0x18,0x00,0x00,0x00,0x00,0x78,0x00,0x78,0x00,0x00,
0x00,0x00,0x60,0x30,0x18,0x30,0x60,0x00,0x3C,0x66,0x06,0x0C,0x18,0x00,0x18,0x00,
0x7C,0x82,0xBA,0xAA,0xBE,0x80,0x7C,0x00,0x7C,0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0x00,
0xFC,0xC6,0xC6,0xFC,0xC6,0xC6,0xFC,0x00,0x7E,0xC0,0xC0,0xC0,0xC0,0xC0,0x7E,0x00,
0xFC,0xC6,0xC6,0xC6,0xC6,0xC6,0xFC,0x00,0xFE,0xC0,0xC0,0xF8,0xC0,0xC0,0xFE,0x00,
0xFE,0xC0,0xC0,0xFC,0xC0,0xC0,0xC0,0x00,0x7E,0xC0,0xC0,0xCE,0xC6,0xC6,0x7E,0x00,
0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0x00,0x3C,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,
0x3C,0x18,0x18,0x18,0x18,0xD8,0x70,0x00,0xC6,0xC6,0xCC,0xF8,0xCC,0xC6,0xC6,0x00,
0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xFE,0x00,0xC6,0xEE,0xFE,0xD6,0xC6,0xC6,0xC6,0x00,
0xC6,0xE6,0xF6,0xDE,0xCE,0xC6,0xC6,0x00,0x7C,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,
0xFC,0xC6,0xC6,0xC6,0xFC,0xC0,0xC0,0x00,0x7C,0xC6,0xC6,0xC6,0xD6,0xCC,0x7A,0x00,
0xFC,0xC6,0xC6,0xFC,0xC6,0xC6,0xC6,0x00,0x7E,0xC0,0xC0,0x7C,0x06,0x06,0xFC,0x00,
0xFC,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,
0xC6,0xC6,0xC6,0xC6,0xC6,0x6C,0x38,0x00,0xC6,0xC6,0xC6,0xD6,0xFE,0xEE,0xC6,0x00,
0xC6,0xC6,0x6C,0x38,0x6C,0xC6,0xC6,0x00,0xCC,0xCC,0xCC,0x78,0x30,0x30,0x30,0x00,
0xFE,0x06,0x0C,0x18,0x30,0x60,0xFE,0x00,0x1C,0x18,0x18,0x18,0x18,0x18,0x1C,0x00,
0x00,0xC0,0x60,0x30,0x18,0x0C,0x06,0x00,0x70,0x30,0x30,0x30,0x30,0x30,0x70,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0x06,0x7E,0xC6,0xFE,0x00,
0xC0,0xC0,0xFC,0xC6,0xC6,0xC6,0xFC,0x00,0x00,0x00,0x7E,0xC0,0xC0,0xC0,0x7E,0x00,
0x06,0x06,0x7E,0xC6,0xC6,0xC6,0x7E,0x00,0x00,0x00,0x7C,0xC6,0xFE,0xC0,0x7C,0x00,
0x3C,0x60,0x60,0xF8,0x60,0x60,0x60,0x00,0x00,0x00,0x7E,0xC6,0xC6,0x7E,0x06,0x7C,
0xC0,0xC0,0xFC,0xC6,0xC6,0xC6,0xC6,0x00,0x18,0x00,0x38,0x18,0x18,0x18,0x3C,0x00,
0x18,0x00,0x18,0x18,0x18,0x18,0x18,0x70,0xC0,0xC0,0xC6,0xCC,0xF8,0xCC,0xC6,0x00,
0x70,0x30,0x30,0x30,0x30,0x30,0x78,0x00,0x00,0x00,0xFC,0xD6,0xD6,0xD6,0xD6,0x00,
0x00,0x00,0xFC,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x7C,0xC6,0xC6,0xC6,0x7C,0x00,
0x00,0x00,0xFC,0xC6,0xC6,0xC6,0xFC,0xC0,0x00,0x00,0x7E,0xC6,0xC6,0xC6,0x7E,0x06,
0x00,0x00,0xFC,0xC6,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x7E,0xC0,0x7C,0x06,0xFC,0x00,
0x30,0x30,0x7C,0x30,0x30,0x30,0x1C,0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,
0x00,0x00,0xC6,0xC6,0xC6,0x6C,0x38,0x00,0x00,0x00,0xC6,0xD6,0xFE,0xEE,0xC6,0x00,
0x00,0x00,0xC6,0x6C,0x38,0x6C,0xC6,0x00,0x00,0x00,0xC6,0xC6,0xC6,0x7E,0x06,0x7C,
0x00,0x00,0xFC,0x18,0x30,0x60,0xFC,0x00,0x0C,0x18,0x18,0x30,0x18,0x18,0x0C,0x00,
0x30,0x30,0x30,0x00,0x30,0x30,0x30,0x00,0x60,0x30,0x30,0x18,0x30,0x30,0x60,0x00};



// ---------------------------------------------------------------------------- Global Variables
char _LineLength;  //sprites per line. TMS9918=4; V9938=8
char cursorY;



// ---------------------------------------------------------------------------- Functions

void main(void)
{
	SCREEN(1);
	
	CopyToVRAM((uint) TILESET_FONT,BASE7,126*8);
	CopyToVRAM((uint) tileset_06x8_COL2,G1_COL,32);
	
	cursorY=0;

	VLocateNL();
	VPRINT(text01);
	VLocateNL();
	VPRINT("Graphic1 (SCREEN 1)");
	
	_LineLength=4; 
	testSPRITES();


  
//---------------------------------------------------------------------only MSX2
/*  if (PEEK(MSXVER)>0)
  {
    SCREEN(4);  //G4 V9938 mode
    CLS();
    setFont();  
    
    VPRINT(0,0,"Graphic3 (SCREEN 4)");
    
    _LineLength=8; 
    testSPRITES();  
  }*/  
//------------------------------------------------------------------------------  
  

  
//-------------------------------------------------------------------------- END
	WAIT(WAIT_TIME*2);
	ClearSprites();
	WAIT(WAIT_TIME*2);
	CLS();
}




/* =============================================================================
One character input (waiting)
============================================================================= */
char INKEY(void) __naked
{
__asm
    
	jp BIOS_CHGET

__endasm;
}



// Generates a pause in the execution of n interruptions.
// PAL: 50=1second. ; NTSC: 60=1second. 
void WAIT(uint cicles)
{
	uint i;
	for(i=0;i<cicles;i++) HALT;
}



//print in screen 1 or 2
/*void VPRINT(char column, char line, char* text)
{
	uint vaddr = BASE10 + (line*32)+column; // calcula la posicion en la VRAM
	VPOKEARRAY(vaddr, text);
}*/



/*void VPOKEARRAY(uint vaddr, char* text)
{
	while(*(text)) VPOKE(vaddr++,*(text++));
}*/



/* =============================================================================
LOCATE
Description: 
	   Moves the cursor to the specified location.
	   
Input:	[char] Position X of the cursor. TEXT 1 (0 to 39) 
										TEXT 2 (0 to 79)
										GRAPHIC 1 (0 to 31)
		[char] Position Y of the cursor. (0 to 23)         
Output:	-
============================================================================= */
void LOCATE(char x, char y) __naked
{
x;
y;
__asm

	inc  A
	ld   H,A

	inc  L

	jp   BIOS_POSIT

__endasm;
}



/* =============================================================================
   Print a text in screen
============================================================================= */
/*void PRINT(char* text) __naked
{ 
text;
__asm
  
nextCHAR:  
	ld   A,(HL)
	or   A
	ret   Z
	call BIOS_CHPUT //Displays one character (BIOS)
	inc  HL
	jr   nextCHAR

__endasm; 
}*/



/*char PEEK(uint address) __naked
{
address;
__asm
	ld   A,(HL)
	ret  
__endasm;
}*/



void setFont(void)
{
	uint ROMfont = *(uint *) CGTABL;

	CopyToVRAM(ROMfont,G2_PAT_A,0x800);	//MSX font pattern
	CopyToVRAM(ROMfont,G2_PAT_B,0x800);	//MSX font pattern
	CopyToVRAM(ROMfont,G2_PAT_C,0x800);	//MSX font pattern
	FillVRAM(G2_COL,0x1800,0xF4);		//colors
}




// TEST SPRITES  ###############################################################
void testSPRITES(void)
{
	setSpritesPatterns();
	
	VLocateNL();
	VPRINT("----------VDP_TMS9918A Functions");

	// sprites 8x8
	VLocateNL();
	VPRINT("SetSpritesSize(0) SPRITES 8x8");
	SetSpritesSize(0);
	SetSpritesZoom(false);  
	showSprites(0);
	WAIT(WAIT_TIME);

	// test sprites 16x16
	VLocateNL();
	VPRINT("SetSpritesSize(1) SPRITES 16x16");
	ClearSprites();			//ClearSprites uses BIOS CLRSPR > Patterns are set to nulls
	setSpritesPatterns();	//load sprite patterns
	SetSpritesSize(1);
	showSprites(2);
	WAIT(WAIT_TIME);

	// test sprites 16x16 + zoom
	VLocateNL();
	VPRINT("SetSpritesZoom(true) SPRITES x2");
	SetSpritesZoom(true);
	WAIT(WAIT_TIME*2);

	//test clear sprites data
	VLocateNL();
	VPRINT("ClearSprites()");
	ClearSprites();
	WAIT(WAIT_TIME*2);

	setSpritesPatterns();
	VLocateNL();
	VPRINT("PUTSPRITE(plane,x,y,color,nSPR)");
	showSprites(2);

	WAIT(WAIT_TIME);
	cursorY++;
	VLocateNL();
	VPRINT("-----------VDP_SPRITES Functions");

	testSpriteVisible();

	testSpritePattern();

	testSpriteColor();
	
	testSpritePosition();

	WAIT(WAIT_TIME);

	VLocateNL();
	VPRINT("SetEarlyClock(0,ON)");
	SetEarlyClock(7,ON);
	WAIT(WAIT_TIME);

	VLocateNL();
	VPRINT("Modify color with EC enabled"); 
	VLocateNL();
	VPRINT("SetSpriteColor(7,7)"); 
	SetSpriteColor(7, 7);
	WAIT(WAIT_TIME);

	VLocateNL();
	VPRINT("SetEarlyClock(0,OFF)");
	SetEarlyClock(7,OFF);
	WAIT(WAIT_TIME);

	cursorY++;
	VLocateNL();
	VPRINT("End of the test...");
	
	VLOCATE(0,cursorY);
	VPRINT(text02);	
	LOCATE(11,cursorY);
	INKEY();
}



void VLocateNL(void)
{
	VLOCATE(0,cursorY++);
}



// Copy sprites data from memory to VRAM
void setSpritesPatterns(void)
{
	HALT;
	CopyToVRAM((uint) SPRITE_DATA,BASE14,32*10);
}



// TEST PUTSPRITE  #############################################################
void showSprites(char offset)
{
	char posX,posY;
	char X=0,Y=0;
	char i=0;
	char sprpat=offset;

	for(i=0;i<16;i++)
	{
		posX=(X*32)+128;
		posY=(Y*32)+63;
		PUTSPRITE(i, posX, posY, sprcol[i], sprpat);
		sprpat++;
		if (sprpat>7+offset) sprpat=offset;
		X++;
		if(X==_LineLength)
		{
			X=0;
			Y++;
		}
		WAIT(10);
	}
}



void setTestSPRcolor(char ncolor)
{
	VLOCATE(0,cursorY);
	VPRINT("SetSpriteColor(7,");
	VPrintFNumber(ncolor,32,2);
	VPRINT(")");
	SetSpriteColor(7, ncolor);
}



// TEST SETSPRITEVISIBLE  ######################################################
void testSpriteVisible(void)
{
	char i,o;

	SetSpriteVisible(0,false);

	for(i=0;i<8;i++)
	{
		for(o=0;o<16;o++)
		{
			if (o==i){
				VLOCATE(0,cursorY);
				VPRINT("SetSpriteVisible(");
				VPrintFNumber(o,32,1);
				VPRINT(",1)");
				SetSpriteVisible(o,ON);
			}else SetSpriteVisible(o,OFF);  
		}
		WAIT(25);  
	}
	cursorY++;
}





// TEST SETSPRITEPATTERN  ######################################################
void testSpritePattern(void)
{
	char i;

	for(i=2;i<10;i++)
	{
		VLOCATE(0,cursorY);
		VPRINT("SetSpritePattern(7,");
		VPrintFNumber(i,32,1);
		VPRINT(")");
		SetSpritePattern(7, i);
		WAIT(25);  
	}
	cursorY++;
}



// TEST SETSPRITECOLOR  ########################################################
void testSpriteColor(void)
{
	char i;

	for(i=0;i<16;i++)
	{
		setTestSPRcolor(i);
		WAIT(25);  
	}
	setTestSPRcolor(14);
	cursorY++;	
}



// TEST SETSPRITEPOSITION  #####################################################
void testSpritePosition(void)
{
	uint i=0;
	char gradX = 64;
	char gradY = 0;
	char posX;
	char posY;
	
	for(i=0;i<660;i++)
	{
		HALT;
		posX=SIN[gradX];
		posY=SIN[gradY];
		VLOCATE(0,cursorY);
		VPRINT("SetSpritePosition(7,");
		VPrintFNumber(posX,32,3);
		VPRINT(",");
		VPrintFNumber(posY,32,3);
		VPRINT(")");
		SetSpritePosition(7,posX,posY);
		gradX++;
		gradY++;
	}
	cursorY++;
}








